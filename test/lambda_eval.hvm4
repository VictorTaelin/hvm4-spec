@wnf = λ{
  #Var: λi. #Var{i}
  #Lam: λf. #Lam{f}
  #App: λf. λx. @app(@wnf(f), x)
}

@app = λ{
  #Lam: λf. λx. @wnf(f(@wnf(x)))
  λf. λx. #App{f, x}
}

@snf = λx. λd.
  @sgo(@wnf(x), d)

@sgo = λ{
  #Var: λi. λd.
    #Var{i}
  #Lam: λf. λd.
    ! D &snf = d;
    #Lam{λx. @snf(f(#Var{D₀}), D₁ + 1)}
  #App: λf. λx. λd.
    ! D &snf = d;
    #App{@snf(f,D₀), @snf(x,D₁)}
}

@C2 = #Lam{λs. #Lam{λz. ! S &C2 = s; #App{S₀, #App{S₁, z}}}}
@K2 = #Lam{λs. #Lam{λz. ! S &K2 = s; #App{S₀, #App{S₁, z}}}}

@main = @snf(#App{@C2, @K2}, 0)
//#Lam{λa.#Lam{λb.#App{#Var{0},#App{#Var{0},#App{#Var{0},#App{#Var{0},#Var{1}}}}}}}
