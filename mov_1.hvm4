@bin = λ{
  0n: λn. λo.λi.λe.e;
  1n+: λ&l. λ&n. (λ{
    0: λo.λi.λe.o(@bin(l, n/2))
    1: λo.λi.λe.i(@bin(l, n/2))
  })(n % 2)
}

@rep = λxs.
  ! O = λp.λ&f.λx.@rep(p,λk.f(f(k)),x)
  ! I = λp.λ&f.λx.@rep(p,λk.f(f(k)),f(x))
  ! E = λf.λx.x
  xs(O, I, E)

@clr = λx. λ&o. λi. λe. x(λp.o(@clr(p)), λp.o(@clr(p)), e)
@clr = λx. λo. λi. λe. x(λp.λo.o(@clr(p)), λp.λo.o(@clr(p)), λo.e, o)
@clr = λx. λo. λi. λe. x(λp.o(@clr(p)), λp.i(@clr(p)), e)

@main = @rep(@bin(32n,12345), @clr, @bin(32n,0))
